{"utilities":{},"programModules":{"EXT001MI":{"program":"EXT001MI","triggers":{},"transactions":{"LstSupervisor":{"sourceUuid":"5ddf9784-aff3-4868-86e2-57055591c8c4","name":"LstSupervisor","program":"EXT001MI","description":"List for Supervisor","active":true,"multi":true,"modified":1628464104322,"modifiedBy":"IIGUANA","outputFields":[{"name":"HIST","description":"History","length":1,"mandatory":false,"type":"N"},{"name":"ZTRI","description":"Trailer ID","length":15,"mandatory":false,"type":"A"},{"name":"ZCDT","description":"Registered Date","length":8,"mandatory":false,"type":"N"},{"name":"ZCTM","description":"Registered Time","length":6,"mandatory":false,"type":"N"},{"name":"SEQN","description":"Sequence","length":3,"mandatory":false,"type":"N"},{"name":"ZACT","description":"Activity Time","length":15,"mandatory":false,"type":"N"},{"name":"TADU","description":"Total Activity Duration","length":15,"mandatory":false,"type":"N"},{"name":"ACTI","description":"Scale Activity","length":10,"mandatory":false,"type":"A"},{"name":"ORNO","description":"M3 Order Number","length":15,"mandatory":false,"type":"A"},{"name":"ITDS","description":"Item Designation","length":60,"mandatory":false,"type":"A"},{"name":"STAS","description":"In Progress Indicator","length":1,"mandatory":false,"type":"A"},{"name":"WGHT","description":"Weight","length":15,"mandatory":false,"type":"N"},{"name":"UNMS","description":"Unit of Measure","length":3,"mandatory":false,"type":"A"},{"name":"SCID","description":"Scale Indicator","length":15,"mandatory":false,"type":"A"},{"name":"LOCA","description":"Location","length":10,"mandatory":false,"type":"A"},{"name":"TRAC","description":"Tractor ID","length":15,"mandatory":false,"type":"A"},{"name":"USER","description":"M3 User","length":10,"mandatory":false,"type":"A"},{"name":"SEAL","description":"Seals Number","length":60,"mandatory":false,"type":"A"},{"name":"SCRP","description":"Reporting Date","length":8,"mandatory":false,"type":"N"},{"name":"WHLO","description":"Warehouse","length":3,"mandatory":false,"type":"A"},{"name":"FACI","description":"Facility","length":3,"mandatory":false,"type":"A"},{"name":"CUNM","description":"Customer Name","length":36,"mandatory":false,"type":"A"},{"name":"PDLN","description":"Product line","length":10,"mandatory":false,"type":"A"}],"inputFields":[{"name":"CONO","description":"Company","length":3,"mandatory":true,"type":"N"},{"name":"WHLO","description":"Warehouse","length":3,"mandatory":true,"type":"A"},{"name":"STAS","description":"In Progress Indicator","length":30,"mandatory":true,"type":"A"},{"name":"HIST","description":"History","length":1,"mandatory":true,"type":"N"},{"name":"TRID","description":"Trailer ID","length":15,"mandatory":false,"type":"A"},{"name":"PDLN","description":"Product Line","length":2,"mandatory":false,"type":"A"}],"utilities":[]}},"batches":{}}},"sources":{"5ddf9784-aff3-4868-86e2-57055591c8c4":{"uuid":"5ddf9784-aff3-4868-86e2-57055591c8c4","updated":1627931877291,"updatedBy":"IIGUANA","created":1628464080963,"createdBy":"IIGUANA","apiVersion":"UNKNOWN","beVersion":"16.0.0.20210517160034","codeHash":"4DF9FF9C2985FC2A691F69A144D64289A4FE4A426FC163BD361D7FCABBB4CCBA","code":"LyoqDQogKiBFWFQwMDFNSS5Mc3RTdXBlcnZpc29yDQogKiBEYXRlICAgICAgICAgQ2hhbmdlZCBieSAgICAgICAgICBEZXNjcmlwdGlvbg0KICogMjAyMTAyMDQgICAgIFBGRVJSRVIgICAgICAgICAgICAgTGlzdCBTdXBlcnZpc29yDQogKiAyMDIxMDQyOCAgICAgUEZFUlJFUiAgICAgICAgICAgICBBZGRlZCBmaWVsZCB2YWx1ZSBmb3IgQUNUTSwgcmV0cmlldmUgZGV0YWlscyBmb3IgU1dJVENIIG9yZGVycw0KICogMjAyMTA1MjUgICAgIFBGRVJSRVIgICAgICAgICAgICAgQ2hhbmdlZCBwYXJhbWV0ZXIgbGVuZ3RoIFpBQ1QgYW5kIFRBRFUgdG8gMTUNCiAqIDIwMjEwNjA0ICAgICBQRkVSUkVSICAgICAgICAgICAgIEFkZGVkIHJldHVybiB3aGVuIGVycm9yIGlzIGVuY291bnRlcmVkLCBpbml0aWFsaXplIE9STE4sIGFkZGVkIHZhbGlkYXRpb24gd2hlbiBpZiBkYXRlIGlzIG51bGwNCiAqIDIwMjEwNjA4ICAgICBTTUFHTkFZICAgICAgICAgICAgIEFkZGVkIFBETE4gYXMgb3V0cHV0IGRhdGEgYW5kIHJlcGxhY2UgQ1VOTSB2YWx1ZSB3aXRoIEZhY2lsaXR5TmFtZQ0KICogMjAyMTA4MDIgICAgIElJR1VBTkEgICAgICAgICAgICAgRmllbGRzIFpBQ1QgYW5kIFRBRFUgaW5jb3JyZWN0bHkgc2l6ZSB0byA2IHRodXMgdHJ1bmNhdGVkIHRoZSBtaW51dGVzLiBDb3JyZWN0ZWQgcGFyYW1ldGVyIGxlbmd0aCBaQUNUIGFuZCBUQURVIHRvIDE1DQogKiovDQoNCmltcG9ydCBqYXZhLnRpbWUuZm9ybWF0LkRhdGVUaW1lRm9ybWF0dGVyOw0KaW1wb3J0IGphdmEudGltZS4qOw0KIA0KcHVibGljIGNsYXNzIExzdFN1cGVydmlzb3IgZXh0ZW5kcyBFeHRlbmRNM1RyYW5zYWN0aW9uIHsNCiAgcHJpdmF0ZSBmaW5hbCBNSUFQSSBtaTsNCiAgcHJpdmF0ZSBmaW5hbCBMb2dnZXJBUEkgbG9nZ2VyOw0KICBwcml2YXRlIGZpbmFsIFByb2dyYW1BUEkgcHJvZ3JhbTsNCiAgcHJpdmF0ZSBmaW5hbCBEYXRhYmFzZUFQSSBkYXRhYmFzZTsNCiAgcHJpdmF0ZSBmaW5hbCBNSUNhbGxlckFQSSBtaUNhbGxlcg0KICANCiAgcHJpdmF0ZSBTdHJpbmcgaW5DT05PLCBpbldITE8sIGluU1RBUywgaW5ISVNULCBpblRSSUQsIGluUERMTiwgSVROT0xJTkU7DQogIHByaXZhdGUgaW50IHJlYWRLZXlzLCByZWFkS2V5czI7DQogIHByaXZhdGUgU3RyaW5nIHpJVERTLCB6Q1VOTywgekNVTk0sIHpPUk5PLCB6U1VOTywgelBETE47DQogIHByaXZhdGUgYm9vbGVhbiBpc1BPLCBpc0NPLCBpc0RPOw0KICANCiAgcHVibGljIExzdFN1cGVydmlzb3IoTUlBUEkgbWksIExvZ2dlckFQSSBsb2dnZXIsIFByb2dyYW1BUEkgcHJvZ3JhbSwgRGF0YWJhc2VBUEkgZGF0YWJhc2UsIE1JQ2FsbGVyQVBJIG1pQ2FsbGVyKSB7DQogICAgdGhpcy5taSA9IG1pOw0KICAgIHRoaXMubG9nZ2VyID0gbG9nZ2VyOw0KICAgIHRoaXMucHJvZ3JhbSA9IHByb2dyYW07DQogICAgdGhpcy5kYXRhYmFzZSA9IGRhdGFiYXNlOw0KICAgIHRoaXMubWlDYWxsZXIgPSBtaUNhbGxlcjsNCiAgfQ0KICANCiAgcHVibGljIHZvaWQgbWFpbigpIHsNCiAgICBBcnJheUxpc3Q8U3RyaW5nW10+IGxpc3RSZXN1bHQgPSBuZXcgQXJyYXlMaXN0PFN0cmluZ1tdPigpOw0KICAgIEl0ZXJhdG9yPFN0cmluZ1tdPiBsaXN0UmVzdWx0SXRlcmF0b3IgPSBudWxsOw0KICAgIA0KICAgIC8vIC0gR2V0IGlucHV0IHZhbHVlcw0KICAgIGluQ09OTyA9IG1pLmluRGF0YS5nZXQoIkNPTk8iKSA9PSBudWxsID8gIiIgOiBtaS5pbkRhdGEuZ2V0KCJDT05PIikudHJpbSgpOw0KICAgIGluV0hMTyA9IG1pLmluRGF0YS5nZXQoIldITE8iKSA9PSBudWxsID8gIiIgOiBtaS5pbkRhdGEuZ2V0KCJXSExPIikudHJpbSgpOw0KICAgIGluU1RBUyA9IG1pLmluRGF0YS5nZXQoIlNUQVMiKSA9PSBudWxsID8gIiIgOiBtaS5pbkRhdGEuZ2V0KCJTVEFTIikudHJpbSgpOw0KICAgIGluSElTVCA9IG1pLmluRGF0YS5nZXQoIkhJU1QiKSA9PSBudWxsID8gIiIgOiBtaS5pbkRhdGEuZ2V0KCJISVNUIikudHJpbSgpOw0KICAgIGluVFJJRCA9IG1pLmluRGF0YS5nZXQoIlRSSUQiKSA9PSBudWxsID8gIiIgOiBtaS5pbkRhdGEuZ2V0KCJUUklEIikudHJpbSgpOw0KICAgIGluUERMTiA9IG1pLmluRGF0YS5nZXQoIlBETE4iKSA9PSBudWxsID8gIiIgOiBtaS5pbkRhdGEuZ2V0KCJQRExOIikudHJpbSgpOw0KICAgIA0KICAgIC8vIC0gVmFsaWRhdGUgcmVxdWlyZWQgaW5wdXQgdmFsdWVzDQogICAgaWYoIiIuZXF1YWxzKGluQ09OTykpew0KICAgICAgbWkuZXJyb3IoIkNvbXBhbnkgaXMgbWFuZGF0b3J5Iik7DQogICAgICByZXR1cm47DQogICAgfQ0KICAgIGlmKCIiLmVxdWFscyhpbldITE8pKXsNCiAgICAgIG1pLmVycm9yKCJXYXJlaG91c2UgaXMgbWFuZGF0b3J5Iik7DQogICAgICByZXR1cm47DQogICAgfQ0KICAgIGlmKCIiLmVxdWFscyhpblNUQVMpKXsNCiAgICAgIG1pLmVycm9yKCJJbiBQcm9ncmVzcyBJbmRpY2F0b3IgaXMgbWFuZGF0b3J5Iik7DQogICAgICByZXR1cm47DQogICAgfQ0KICAgIGlmKCIiLmVxdWFscyhpbkhJU1QpKXsNCiAgICAgIG1pLmVycm9yKCJIaXN0b3J5IGlzIG1hbmRhdG9yeSIpOw0KICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICAvLyBTZWFyY2ggdHJhaWxlciBJRCBsaXN0DQogICAgREJBY3Rpb24gZGJBY3Rpb247DQogICAgRXhwcmVzc2lvbkZhY3RvcnkgZXhwID0gZGF0YWJhc2UuZ2V0RXhwcmVzc2lvbkZhY3RvcnkoIk1JVEJBTCIpOw0KICAgIGV4cCA9IGV4cC5lcSgiTUJXSFNMIiwgIlM4MSIpOw0KICAgIGV4cCA9IGV4cC5hbmQoZXhwLmVxKCJNQlNUVFgiLCBpblNUQVMpKTsNCiAgICBkYkFjdGlvbiA9IGRhdGFiYXNlLnRhYmxlKCJNSVRCQUwiKS5pbmRleCgiMDAiKS5tYXRjaGluZyhleHApLnNlbGVjdGlvbigiTUJJVE5PIikuYnVpbGQoKTsNCiAgICANCiAgICBEQkNvbnRhaW5lciBNSVRCQUwgPSBkYkFjdGlvbi5jcmVhdGVDb250YWluZXIoKTsNCiAgICBNSVRCQUwuc2V0SW50KCJNQkNPTk8iLCBpbkNPTk8udG9JbnRlZ2VyKCkpOw0KICAgIE1JVEJBTC5zZXQoIk1CV0hMTyIsIGluV0hMTyk7DQogICAgaWYoISIiLmVxdWFscyhpblRSSUQpKSB7DQogICAgICBNSVRCQUwuc2V0KCJNQklUTk8iLCBpblRSSUQpOw0KICAgICAgcmVhZEtleXMgPSAzOw0KICAgIH0gZWxzZSB7DQogICAgICByZWFkS2V5cyA9IDI7DQogICAgfQ0KICAgIA0KICAgIENsb3N1cmU8Pz4gbGlzdFJlY29yZHMgPSB7REJDb250YWluZXIgZGF0YSAtPg0KICAgICAgDQogICAgICBTdHJpbmcgSVROTyA9IGRhdGEuZ2V0KCJNQklUTk8iKS50b1N0cmluZygpLnRyaW0oKTsNCiAgICANCiAgICAgIC8vIFJldHJpZXZlIHNjYWxlICAgDQogICAgICBFeHByZXNzaW9uRmFjdG9yeSBleHAyID0gZGF0YWJhc2UuZ2V0RXhwcmVzc2lvbkZhY3RvcnkoIkVYVFNDTCIpOw0KICAgICAgZXhwMiA9IGV4cDIuZXEoIkVYSElTVCIsICIwIik7DQogICAgICBleHAyID0gZXhwMi5hbmQoZXhwMi5lcSgiRVhXSExPIiwgaW5XSExPKSk7DQogICAgICBEQkFjdGlvbiBkYkFjdGlvbjIgPSBkYXRhYmFzZS50YWJsZSgiRVhUU0NMIikuaW5kZXgoIjAwIikubWF0Y2hpbmcoZXhwMikuc2VsZWN0QWxsRmllbGRzKCkuYnVpbGQoKTsNCiAgICAgIERCQ29udGFpbmVyIEVYVFNDTCA9IGRiQWN0aW9uMi5jcmVhdGVDb250YWluZXIoKTsNCiAgICAgIEVYVFNDTC5zZXRJbnQoIkVYQ09OTyIsIGluQ09OTy50b0ludGVnZXIoKSk7DQogICAgICBFWFRTQ0wuc2V0KCJFWFRSSUQiLCBJVE5PKTsNCiAgICAgIHJlYWRLZXlzMiA9IDI7DQoNCiAgICAgIENsb3N1cmU8Pz4gbGlzdEVYVFNDTCA9IHtEQkNvbnRhaW5lciBkYXRhRVhUU0NMIC0+DQogICAgICAgIA0KICAgICAgICBTdHJpbmdbXSBjdXJyUmVzdWx0ID0gWw0KICAgICAgICAgIGRhdGFFWFRTQ0wuZ2V0KCJFWE9STk8iKS50b1N0cmluZygpLnRyaW0oKSwNCiAgICAgICAgICBkYXRhRVhUU0NMLmdldCgiRVhPUkxOIikudG9TdHJpbmcoKS50cmltKCksDQogICAgICAgICAgZGF0YUVYVFNDTC5nZXQoIkVYTE9JRCIpLnRvU3RyaW5nKCkudHJpbSgpLA0KICAgICAgICAgIGRhdGFFWFRTQ0wuZ2V0KCJFWEhJU1QiKS50b1N0cmluZygpLnRyaW0oKSwNCiAgICAgICAgICBkYXRhRVhUU0NMLmdldCgiRVhUUklEIikudG9TdHJpbmcoKS50cmltKCksDQogICAgICAgICAgZGF0YUVYVFNDTC5nZXQoIkVYU0NEVCIpLnRvU3RyaW5nKCkudHJpbSgpLA0KICAgICAgICAgIGRhdGFFWFRTQ0wuZ2V0KCJFWFNDVE0iKS50b1N0cmluZygpLnRyaW0oKSwNCiAgICAgICAgICBkYXRhRVhUU0NMLmdldCgiRVhTRVFOIikudG9TdHJpbmcoKS50cmltKCksDQogICAgICAgICAgZGF0YUVYVFNDTC5nZXQoIkVYQUNUSSIpLnRvU3RyaW5nKCkudHJpbSgpLA0KICAgICAgICAgIGRhdGFFWFRTQ0wuZ2V0KCJFWFNUQVMiKS50b1N0cmluZygpLnRyaW0oKSwNCiAgICAgICAgICBkYXRhRVhUU0NMLmdldCgiRVhXR0hUIikudG9TdHJpbmcoKS50cmltKCksDQogICAgICAgICAgZGF0YUVYVFNDTC5nZXQoIkVYU0NJRCIpLnRvU3RyaW5nKCkudHJpbSgpLA0KICAgICAgICAgIGRhdGFFWFRTQ0wuZ2V0KCJFWExPQ0EiKS50b1N0cmluZygpLnRyaW0oKSwNCiAgICAgICAgICBkYXRhRVhUU0NMLmdldCgiRVhUUkFDIikudG9TdHJpbmcoKS50cmltKCksDQogICAgICAgICAgZGF0YUVYVFNDTC5nZXQoIkVYVVNFUiIpLnRvU3RyaW5nKCkudHJpbSgpLA0KICAgICAgICAgIGRhdGFFWFRTQ0wuZ2V0KCJFWFNFQUwiKS50b1N0cmluZygpLnRyaW0oKSwNCiAgICAgICAgICBkYXRhRVhUU0NMLmdldCgiRVhTQ1JQIikudG9TdHJpbmcoKS50cmltKCksDQogICAgICAgICAgZGF0YUVYVFNDTC5nZXQoIkVYV0hMTyIpLnRvU3RyaW5nKCkudHJpbSgpLA0KICAgICAgICAgIGRhdGFFWFRTQ0wuZ2V0KCJFWEZBQ0kiKS50b1N0cmluZygpLnRyaW0oKQ0KICAgICAgICBdOw0KICAgICAgICBsaXN0UmVzdWx0LmFkZChjdXJyUmVzdWx0KTsNCiAgICAgIH0NCiAgICAgIGRiQWN0aW9uMi5yZWFkQWxsKEVYVFNDTCwgcmVhZEtleXMyLCBsaXN0RVhUU0NMKQ0KICAgIH0NCiAgICANCiAgICBpZighZGJBY3Rpb24ucmVhZEFsbChNSVRCQUwsIHJlYWRLZXlzLCBsaXN0UmVjb3Jkcykpew0KICAgICAgbWkuZXJyb3IoIlJlY29yZCBkb2VzIG5vdCBleGlzdCIpOw0KICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICBpbnQgY3RyID0gMDsNCiAgICBsaXN0UmVzdWx0SXRlcmF0b3IgPSBsaXN0UmVzdWx0Lml0ZXJhdG9yKCk7DQogICAgWm9uZWREYXRlVGltZSBjdXJyRGF0ZSA9IGdldFVUQ0RhdGVUaW1lKGluV0hMTywgIiIsICIiKTsNCiAgICBTdHJpbmcgQUNUTSwgVEFEVSwgZmlyc3RTQ0RULCBmaXJzdFNDVE07DQogICAgU3RyaW5nIHByZXZPUk5PID0gIiIsIHByZXZPUkxOPSAiMCI7DQogICAgDQogICAgd2hpbGUobGlzdFJlc3VsdEl0ZXJhdG9yLmhhc05leHQoKSkgew0KICAgICAgU3RyaW5nW10gY3VyclJlc3VsdCA9IGxpc3RSZXN1bHRJdGVyYXRvci5uZXh0KCk7DQogICAgICBib29sZWFuIG91dHB1dFJlY29yZCA9IGZhbHNlOw0KICAgICAgYm9vbGVhbiBvdXRwdXRQRExOUmVjb3JkID0gdHJ1ZTsNCiAgICAgIA0KICAgICAgaWYgKGN0ciA9PSAwKSB7DQogICAgICAgIEFDVE0gPSAiMGQgMGggMG0iOw0KICAgICAgICBUQURVID0gIjBkIDBoIDBtIjsNCiAgICAgICAgZmlyc3RTQ0RUID0gY3VyclJlc3VsdFs1XTsNCiAgICAgICAgZmlyc3RTQ1RNID0gY3VyclJlc3VsdFs2XTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIFN0cmluZ1tdIHByZXZSZXN1bHQgPSBsaXN0UmVzdWx0LmdldChjdHItMSk7DQogICAgICAgIHByZXZPUk5PID0gcHJldlJlc3VsdFswXTsNCiAgICAgICAgcHJldk9STE4gPSBwcmV2UmVzdWx0WzFdOw0KICAgICAgICBpZiAoIWN1cnJSZXN1bHRbNF0uZXF1YWxzKHByZXZSZXN1bHRbNF0pIHx8ICFjdXJyUmVzdWx0WzBdLmVxdWFscyhwcmV2UmVzdWx0WzBdKSkgew0KICAgICAgICAgIEFDVE0gPSAiMGQgMGggMG0iOw0KICAgICAgICAgIFRBRFUgPSAiMGQgMGggMG0iOw0KICAgICAgICAgIGZpcnN0U0NEVCA9IGN1cnJSZXN1bHRbNV07DQogICAgICAgICAgZmlyc3RTQ1RNID0gY3VyclJlc3VsdFs2XTsNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgICAgDQogICAgICAvLyBvdXB1dCBsYXN0IHJlY29yZA0KICAgICAgaWYgKCFsaXN0UmVzdWx0SXRlcmF0b3IuaGFzTmV4dCgpKSB7DQogICAgICAgIG91dHB1dFJlY29yZCA9IHRydWU7DQogICAgICB9IGVsc2Ugew0KICAgICAgICAvLyBvdXRwdXQgbGFzdCByZWNvcmQgZm9yIFRSSUQNCiAgICAgICAgU3RyaW5nW10gbmV4dFJlc3VsdCA9IGxpc3RSZXN1bHQuZ2V0KGN0cisxKTsNCiAgICAgICAgaWYgKCFuZXh0UmVzdWx0WzRdLmVxdWFscyhjdXJyUmVzdWx0WzRdKSkgew0KICAgICAgICAgIG91dHB1dFJlY29yZCA9IHRydWU7DQogICAgICAgIH0NCiAgICAgIH0NCiAgICAgIA0KICAgICAgaWYgKG91dHB1dFJlY29yZCkgew0KICAgICAgICB6SVREUyA9ICIiOw0KICAgICAgICB6Q1VOTSA9ICIiOw0KICAgICAgICB6Q1VOTyA9ICIiOw0KICAgICAgICB6T1JOTyA9ICIiOw0KICAgICAgICB6U1VOTyA9ICIiOw0KICAgICAgICBpc1BPID0gZmFsc2U7DQogICAgICAgIGlzQ08gPSBmYWxzZTsNCiAgICAgICAgaXNETyA9IGZhbHNlOw0KICAgICAgICANCiAgICAgICAgDQogICAgICAgIGlmIChjdXJyUmVzdWx0WzhdLnRyaW0oKS5lcXVhbHNJZ25vcmVDYXNlKCJTV0lUQ0giKSkgew0KICAgICAgICAgIGdldE9yZGVyRGV0YWlscyhwcmV2T1JOTywgcHJldk9STE4sIGN1cnJSZXN1bHRbMTddKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICBpZiAoISIiLmVxdWFscyhjdXJyUmVzdWx0WzBdKSApew0KICAgICAgICAgICAgZ2V0T3JkZXJEZXRhaWxzKGN1cnJSZXN1bHRbMF0sIGN1cnJSZXN1bHRbMV0sIGN1cnJSZXN1bHRbMTddKTsNCiAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgaWYoISIiLmVxdWFscyhjdXJyUmVzdWx0WzJdKSkgew0KICAgICAgICAgICAgICBnZXRMb2FkSWREZXRhaWxzKGN1cnJSZXN1bHRbMl0sIGN1cnJSZXN1bHRbMTddKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgIA0KICAgICAgICBpZiAoIWluUERMTi5lcXVhbHMoIiIpKSB7DQogICAgICAgICAgaWYgKHpQRExOLmVxdWFscygiIikpIHsNCiAgICAgICAgICAgIG91dHB1dFBETE5SZWNvcmQgPSBmYWxzZTsNCiAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgaWYgKCF6UERMTi5lcXVhbHMoaW5QRExOKSkgew0KICAgICAgICAgICAgICBvdXRwdXRQRExOUmVjb3JkID0gZmFsc2U7DQogICAgICAgICAgICB9DQogICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBpZiAob3V0cHV0UERMTlJlY29yZCkgeyANCiAgICAgICAgDQogICAgICAgICAgU3RyaW5nIHVuaXRPZk1lYXN1cmUgPSAiIjsNCiAgICAgICAgICBpZiAoIWN1cnJSZXN1bHRbMTFdLmVxdWFscygiIikpIHsNCiAgICAgICAgICAgIHVuaXRPZk1lYXN1cmUgPSBnZXRVbml0T2ZNZWFzdXJlKGN1cnJSZXN1bHRbMTFdKTsNCiAgICAgICAgICB9DQogICAgICAgICAgDQogICAgICAgICAgDQogICAgICAgICAgU3RyaW5nIHRpbWUgPSBjdXJyUmVzdWx0WzZdLnBhZExlZnQoNCwgIjAiKS5wYWRSaWdodCg2LCAiMCIpOw0KICAgICAgICAgIA0KICAgICAgICAgIFpvbmVkRGF0ZVRpbWUgcHJldkRhdGUgPSBnZXRVVENEYXRlVGltZShjdXJyUmVzdWx0WzE3XSwgY3VyclJlc3VsdFs1XSwgdGltZSk7DQogICAgICAgICAgRHVyYXRpb24gZHVyYXRpb24gPSBEdXJhdGlvbi5iZXR3ZWVuKHByZXZEYXRlLCBjdXJyRGF0ZSk7DQogICAgICAgICAgbG9uZyBkaWZmTWlsbGkgPSBkdXJhdGlvbi50b01pbGxpcygpOw0KICAgICAgICAgIGludCBkaWZmTWlucyA9IChpbnQpKGRpZmZNaWxsaS5pbnRkaXYoNjAwMDApKSU2MDsNCiAgICAgICAgICBpbnQgZGlmZkhvdXJzID0gKGludCkoZGlmZk1pbGxpLmludGRpdigzNjAwMDAwKSklMjQ7DQogICAgICAgICAgaW50IGRpZmZEYXlzID0gKGludCkoZGlmZk1pbGxpLmludGRpdig4NjQwMDAwMCkpJTYwOw0KICAgICAgICAgIEFDVE0gPSBkaWZmRGF5cyArICJkICIgKyBkaWZmSG91cnMgKyAiaCAiICsgZGlmZk1pbnMgKyAibSI7DQogICAgICAgICAgDQogICAgICAgICAgLy8gY2FsY3VsYXRlIFRBRFU6IGN1cnJlbnQgZGF0ZS90aW1lIC0gZmlyc3QgZGF0ZS90aW1lIGZvciBUUklEL09STk8NCiAgICAgICAgICB0aW1lID0gZmlyc3RTQ1RNLnBhZExlZnQoNCwgIjAiKS5wYWRSaWdodCg2LCAiMCIpOw0KICAgICAgICAgIFpvbmVkRGF0ZVRpbWUgZmlyc3REYXRlID0gZ2V0VVRDRGF0ZVRpbWUoY3VyclJlc3VsdFsxN10sIGZpcnN0U0NEVCwgdGltZSk7DQogICAgICAgICAgZHVyYXRpb24gPSBEdXJhdGlvbi5iZXR3ZWVuKGZpcnN0RGF0ZSwgY3VyckRhdGUpOw0KICAgICAgICAgIGRpZmZNaWxsaSA9IGR1cmF0aW9uLnRvTWlsbGlzKCk7DQogICAgICAgICAgZGlmZk1pbnMgPSAoaW50KShkaWZmTWlsbGkuaW50ZGl2KDYwMDAwKSklNjA7DQogICAgICAgICAgZGlmZkhvdXJzID0gKGludCkoZGlmZk1pbGxpLmludGRpdigzNjAwMDAwKSklMjQ7DQogICAgICAgICAgZGlmZkRheXMgPSAoaW50KShkaWZmTWlsbGkuaW50ZGl2KDg2NDAwMDAwKSklNjA7DQogICAgICAgICAgVEFEVSA9IGRpZmZEYXlzICsgImQgIiArIGRpZmZIb3VycyArICJoICIgKyBkaWZmTWlucyArICJtIjsNCiAgICAgICAgICANCiAgICAgICAgICANCiAgICAgICAgICBtaS5vdXREYXRhLnB1dCgiT1JOTyIsIHpPUk5PKTsNCiAgICAgICAgICBtaS5vdXREYXRhLnB1dCgiSVREUyIsIHpJVERTKTsNCiAgICAgICAgICBtaS5vdXREYXRhLnB1dCgiQ1VOTSIsIHpDVU5NKTsNCiAgICAgICAgICBtaS5vdXREYXRhLnB1dCgiVU5NUyIsIHVuaXRPZk1lYXN1cmUpOw0KICAgICAgICAgIG1pLm91dERhdGEucHV0KCJISVNUIiwgY3VyclJlc3VsdFszXSk7DQogICAgICAgICAgbWkub3V0RGF0YS5wdXQoIlpUUkkiLCBjdXJyUmVzdWx0WzRdKTsNCiAgICAgICAgICBtaS5vdXREYXRhLnB1dCgiWkNEVCIsIGN1cnJSZXN1bHRbNV0pOw0KICAgICAgICAgIG1pLm91dERhdGEucHV0KCJaQ1RNIiwgY3VyclJlc3VsdFs2XSk7DQogICAgICAgICAgbWkub3V0RGF0YS5wdXQoIlNFUU4iLCBjdXJyUmVzdWx0WzddKTsNCiAgICAgICAgICBtaS5vdXREYXRhLnB1dCgiQUNUSSIsIGN1cnJSZXN1bHRbOF0pOw0KICAgICAgICAgIG1pLm91dERhdGEucHV0KCJTVEFTIiwgY3VyclJlc3VsdFs5XSk7DQogICAgICAgICAgbWkub3V0RGF0YS5wdXQoIldHSFQiLCBjdXJyUmVzdWx0WzEwXSk7DQogICAgICAgICAgbWkub3V0RGF0YS5wdXQoIlNDSUQiLCBjdXJyUmVzdWx0WzExXSk7DQogICAgICAgICAgbWkub3V0RGF0YS5wdXQoIkxPQ0EiLCBjdXJyUmVzdWx0WzEyXSk7DQogICAgICAgICAgbWkub3V0RGF0YS5wdXQoIlRSQUMiLCBjdXJyUmVzdWx0WzEzXSk7DQogICAgICAgICAgbWkub3V0RGF0YS5wdXQoIlVTRVIiLCBjdXJyUmVzdWx0WzE0XSk7DQogICAgICAgICAgbWkub3V0RGF0YS5wdXQoIlNFQUwiLCBjdXJyUmVzdWx0WzE1XSk7DQogICAgICAgICAgbWkub3V0RGF0YS5wdXQoIlNDUlAiLCBjdXJyUmVzdWx0WzE2XSk7DQogICAgICAgICAgbWkub3V0RGF0YS5wdXQoIldITE8iLCBjdXJyUmVzdWx0WzE3XSk7DQogICAgICAgICAgbWkub3V0RGF0YS5wdXQoIkZBQ0kiLCBjdXJyUmVzdWx0WzE4XSk7DQogICAgICAgICAgbWkub3V0RGF0YS5wdXQoIlpBQ1QiLCBBQ1RNKTsNCiAgICAgICAgICBtaS5vdXREYXRhLnB1dCgiVEFEVSIsIFRBRFUpOw0KICAgICAgICAgIG1pLm91dERhdGEucHV0KCJQRExOIiwgelBETE4pOw0KICAgICAgICAgIG1pLndyaXRlKCk7DQogICAgICAgIH0NCiAgICAgIH0NCiAgICAgIGN0cisrOw0KICAgIH0NCiAgICANCiAgfQ0KICANCiAgLyoqDQogICAqIEdldCBvcmRlciBkZXRhaWxzDQogICAqKi8NCiAgcHJpdmF0ZSB2b2lkIGdldE9yZGVyRGV0YWlscyhTdHJpbmcgb3JkZXJObywgU3RyaW5nIG9yZGVyTGluZSwgU3RyaW5nIHdhcmVob3VzZSkgew0KICAgIFN0cmluZyBGQUNJID0gIiI7DQogICAgZGVmIHBhcmFtQ09MaW5lID0gWyJDT05PIiA6IGluQ09OTywgIk9STk8iIDogb3JkZXJObywgIlBPTlIiIDogb3JkZXJMaW5lLCAiUE9TWCIgOiAiMCJdDQogICAgZGVmIGNhbGxiYWNrQ09MaW5lID0gew0KICAgICAgTWFwPFN0cmluZywgU3RyaW5nPiByZXNwb25zZSAtPiANCiAgICAgIGlmIChyZXNwb25zZS5JVE5PICE9IG51bGwpIHsNCiAgICAgICAgICB6SVREUyA9IHJlc3BvbnNlLklURFMudHJpbSgpOw0KICAgICAgICAgIHpPUk5PID0gb3JkZXJObzsNCiAgICAgICAgICBJVE5PTElORSA9IHJlc3BvbnNlLklUTk8udHJpbSgpOw0KICAgICAgICAgIGlzQ08gPSB0cnVlOw0KICAgICAgfQ0KICAgIH0NCiAgICBtaUNhbGxlci5jYWxsKCJPSVMxMDBNSSIsIkdldExpbmUiLCBwYXJhbUNPTGluZSwgY2FsbGJhY2tDT0xpbmUpOw0KICAgIA0KICAgIGlmIChpc0NPKSB7DQogICAgICBkZWYgcGFyYW1DT0hlYWQgPSBbIkNPTk8iIDogaW5DT05PLCAiT1JOTyIgOiBvcmRlck5vXQ0KICAgICAgZGVmIGNhbGxiYWNrQ09IZWFkID0gew0KICAgICAgICBNYXA8U3RyaW5nLCBTdHJpbmc+IHJlc3BvbnNlIC0+IA0KICAgICAgICBpZiAocmVzcG9uc2UuT1JOTyAhPSBudWxsKSB7DQogICAgICAgICAgekNVTk8gPSByZXNwb25zZS5DVU5PLnRyaW0oKTsNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgICAgbWlDYWxsZXIuY2FsbCgiT0lTMTAwTUkiLCJHZXRIZWFkIiwgcGFyYW1DT0hlYWQsIGNhbGxiYWNrQ09IZWFkKTsNCiAgICAgIA0KICAgICAgZGVmIHBhcmFtQ3VzdG9tZXIgPSBbIkNPTk8iIDogaW5DT05PLCAiQ1VOTyIgOiB6Q1VOT10NCiAgICAgIGRlZiBjYWxsYmFja0N1c3RvbWVyID0gew0KICAgICAgICBNYXA8U3RyaW5nLCBTdHJpbmc+IHJlc3BvbnNlIC0+IA0KICAgICAgICBpZiAocmVzcG9uc2UuQ1VOTyAhPSBudWxsKSB7DQogICAgICAgICAgekNVTk0gPSByZXNwb25zZS5DVU5NLnRyaW0oKTsNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgICAgbWlDYWxsZXIuY2FsbCgiQ1JTNjEwTUkiLCJHZXRCYXNpY0RhdGEiLCBwYXJhbUN1c3RvbWVyLCBjYWxsYmFja0N1c3RvbWVyKTsNCiAgICAgIA0KICAgIH0NCiAgICANCiAgICAvLyBpZiBub3QgQ08sIGNoZWNrIGlmIFBPDQogICAgaWYgKCFpc0NPKSB7DQogICAgICANCiAgICAgIERCQWN0aW9uIGRiQWN0aW9uID0gZGF0YWJhc2UudGFibGUoIk1QTElORSIpLmluZGV4KCIwMCIpLnNlbGVjdGlvbigiSUJQSVREIiwgIklCU1VOTyIsICJJQklUTk8iKS5idWlsZCgpOw0KICAgICAgREJDb250YWluZXIgTVBMSU5FID0gZGJBY3Rpb24uY3JlYXRlQ29udGFpbmVyKCk7DQogICAgICBNUExJTkUuc2V0SW50KCJJQkNPTk8iLCBpbkNPTk8udG9JbnRlZ2VyKCkpOw0KICAgICAgTVBMSU5FLnNldCgiSUJQVU5PIiwgb3JkZXJObyk7DQogICAgICBNUExJTkUuc2V0SW50KCJJQlBOTEkiLCBvcmRlckxpbmUudG9JbnRlZ2VyKCkpOw0KICAgICAgTVBMSU5FLnNldEludCgiSUJQTkxTIiwgMCk7DQogICAgICANCiAgICAgIGlmIChkYkFjdGlvbi5yZWFkKE1QTElORSkpIHsNCiAgICAgICAgek9STk8gPSBvcmRlck5vOw0KICAgICAgICB6SVREUyA9IE1QTElORS5nZXQoIklCUElURCIpLnRvU3RyaW5nKCkudHJpbSgpOw0KICAgICAgICB6U1VOTyA9IE1QTElORS5nZXQoIklCU1VOTyIpLnRvU3RyaW5nKCkudHJpbSgpOw0KICAgICAgICBJVE5PTElORSA9IE1QTElORS5nZXQoIklCSVROTyIpLnRvU3RyaW5nKCkudHJpbSgpOw0KICAgICAgICBpc1BPID0gdHJ1ZTsNCiAgICAgIH0NCiAgICAgIA0KICAgICAgaWYgKGlzUE8pIHsNCiAgICAgICAgZGVmIHBhcmFtU3VwcGxpZXIgPSBbIkNPTk8iIDogaW5DT05PLCAiU1VOTyIgOiB6U1VOT10NCiAgICAgICAgZGVmIGNhbGxiYWNrU3VwcGxpZXIgPSB7DQogICAgICAgICAgTWFwPFN0cmluZywgU3RyaW5nPiByZXNwb25zZSAtPiANCiAgICAgICAgICBpZiAocmVzcG9uc2UuU1VOTyAhPSBudWxsKSB7DQogICAgICAgICAgICB6Q1VOTSA9IHJlc3BvbnNlLlNVTk0udHJpbSgpOw0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBtaUNhbGxlci5jYWxsKCJDUlM2MjBNSSIsIkdldEJhc2ljRGF0YSIsIHBhcmFtU3VwcGxpZXIsIGNhbGxiYWNrU3VwcGxpZXIpOw0KICAgICAgfQ0KICAgIH0NCiAgICANCiAgICBpZiAoIWlzQ08gJiYgIWlzUE8pIHsNCiAgICAgIGRlZiBwYXJhbURPTGluZSA9IFsiVFJOUiIgOiBvcmRlck5vLCAiUE9OUiIgOiBvcmRlckxpbmUsICJQT1NYIiA6ICIwIl0NCiAgICAgIGRlZiBjYWxsYmFja0RPTGluZSA9IHsNCiAgICAgICAgTWFwPFN0cmluZywgU3RyaW5nPiByZXNwb25zZSAtPiANCiAgICAgICAgaWYgKHJlc3BvbnNlLlBPTlIgIT0gbnVsbCkgew0KICAgICAgICAgIHpJVERTID0gcmVzcG9uc2UuSVREUy50cmltKCk7DQogICAgICAgICAgek9STk8gPSBvcmRlck5vOw0KICAgICAgICAgIElUTk9MSU5FID0gcmVzcG9uc2UuSVROTy50cmltKCk7DQogICAgICAgICAgaXNETyA9IHRydWU7DQogICAgICAgIH0NCiAgICAgIH0NCiAgICAgIG1pQ2FsbGVyLmNhbGwoIk1NUzEwME1JIiwiR2V0TGluZSIsIHBhcmFtRE9MaW5lLCBjYWxsYmFja0RPTGluZSk7DQogICAgICANCiAgICAgIGlmIChpc0RPKSB7DQogICAgICAgIGRlZiBwYXJhbURPSGVhZCA9IFsiVFJOUiIgOiBvcmRlck5vXQ0KICAgICAgICBkZWYgY2FsbGJhY2tET0hlYWQgPSB7DQogICAgICAgICAgTWFwPFN0cmluZywgU3RyaW5nPiByZXNwb25zZSAtPiANCiAgICAgICAgICBpZiAocmVzcG9uc2UuVFJOUiAhPSBudWxsKSB7DQogICAgICAgICAgICB6Q1VOTyA9IHJlc3BvbnNlLlRXTE8udHJpbSgpOw0KICAgICAgICAgICAgRkFDSSA9IHJlc3BvbnNlLkZBQ0kudHJpbSgpOw0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBtaUNhbGxlci5jYWxsKCJNTVMxMDBNSSIsIkdldEhlYWQiLCBwYXJhbURPSGVhZCwgY2FsbGJhY2tET0hlYWQpOw0KICAgICAgICANCiAgICAgICAgZGVmIHBhcmFtV2FyZWhvdXNlID0gWyJGQUNJIiA6IEZBQ0ksICJJVE5PIiA6IElUTk9MSU5FXQ0KICAgICAgICBkZWYgY2FsbGJhY2tXYXJlaG91c2UgPSB7DQogICAgICAgICAgTWFwPFN0cmluZywgU3RyaW5nPiByZXNwb25zZSAtPiANCiAgICAgICAgICBpZiAocmVzcG9uc2UuRkFDSSAhPSBudWxsKSB7DQogICAgICAgICAgICB6Q1VOTSA9IHJlc3BvbnNlLkZBQ04udHJpbSgpOw0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBtaUNhbGxlci5jYWxsKCJNTVMyMDBNSSIsIkdldEl0bUZhYyIsIHBhcmFtV2FyZWhvdXNlLCBjYWxsYmFja1dhcmVob3VzZSk7DQogICAgICB9DQogICAgfQ0KICAgIA0KICAgIGxvZ2dlci5kZWJ1ZygiSXRlbU51bWJlcjogeyRJVE5PTElORX0gYW5kIFdhcmVob3VzZSA6IHskd2FyZWhvdXNlfSIpOw0KICAgIGRlZiBwYXJhbVByb2RMaW5lID0gWyJDT05PIiA6IGluQ09OTywgIldITE8iIDogd2FyZWhvdXNlLCAiSVROTyIgOiBJVE5PTElORV0NCiAgICBkZWYgY2FsbGJhY2tQcm9kTGluZSA9IHsNCiAgICAgIE1hcDxTdHJpbmcsIFN0cmluZz4gcmVzcG9uc2UgLT4gDQogICAgICBpZiAocmVzcG9uc2UuUERMTiAhPSBudWxsKSB7DQogICAgICAgIHpQRExOID0gcmVzcG9uc2UuUERMTi50cmltKCk7DQogICAgICB9DQogICAgfQ0KICAgIG1pQ2FsbGVyLmNhbGwoIk1NUzIwME1JIiwiR2V0SXRtV2hzQmFzaWMiLCBwYXJhbVByb2RMaW5lLCBjYWxsYmFja1Byb2RMaW5lKTsNCiAgICANCiAgfQ0KICANCiAgLyoqDQogICAqIFJldHJpZXZlIE9yZGVyIE51bWJlciBnaXZlbiBMb2FkIElkDQogICAqKi8NCiAgcHJpdmF0ZSB2b2lkIGdldExvYWRJZERldGFpbHMoU3RyaW5nIGxvYWRJZCwgU3RyaW5nIHdhcmVob3VzZSkgew0KCQlTdHJpbmcgb3JkZXJObywgb3JkZXJMaW5lOw0KCQkNCiAgICAvLyBSZXRyaWV2ZSBFWFRPTE4NCiAgICBEQkFjdGlvbiBkYkFjdGlvbiA9IGRhdGFiYXNlLnRhYmxlKCJFWFRPTE4iKS5pbmRleCgiMTAiKS5zZWxlY3Rpb24oIkVYT1JOTyIsICJFWFBPTlIiLCAiRVhQT1NYIiwgIkVYSUxJRCIpLmJ1aWxkKCk7DQogICAgREJDb250YWluZXIgRVhUT0xOID0gZGJBY3Rpb24uY3JlYXRlQ29udGFpbmVyKCk7DQogICAgRVhUT0xOLnNldEludCgiRVhDT05PIiwgaW5DT05PLnRvSW50ZWdlcigpKTsNCiAgICBFWFRPTE4uc2V0KCJFWElMSUQiLCBsb2FkSWQpOw0KICAgIGlmIChkYkFjdGlvbi5yZWFkKEVYVE9MTikpIHsNCiAgICAgIGdldE9yZGVyRGV0YWlscyhFWFRPTE4uZ2V0KCJFWE9STk8iKS50b1N0cmluZygpLCBFWFRPTE4uZ2V0KCJFWFBPTlIiKS50b1N0cmluZygpLCB3YXJlaG91c2UpOw0KICAgICAgek9STk8gPSBsb2FkSWQ7DQogICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIC8vIFJldHJpZXZlIEVYVE1QTA0KICAgIGRiQWN0aW9uID0gZGF0YWJhc2UudGFibGUoIkVYVE1QTCIpLmluZGV4KCIxMCIpLnNlbGVjdGlvbigiRVhQVU5PIiwgIkVYUE5MSSIsICJFWFBOTFMiLCAiRVhJTElEIikuYnVpbGQoKTsNCiAgICBEQkNvbnRhaW5lciBFWFRNUEwgPSBkYkFjdGlvbi5jcmVhdGVDb250YWluZXIoKTsNCiAgICBFWFRPTE4uc2V0SW50KCJFWENPTk8iLCBpbkNPTk8udG9JbnRlZ2VyKCkpOw0KICAgIEVYVE9MTi5zZXQoIkVYSUxJRCIsIGxvYWRJZCk7DQogICAgaWYgKGRiQWN0aW9uLnJlYWQoRVhUTVBMKSkgew0KICAgICAgZ2V0T3JkZXJEZXRhaWxzKEVYVE1QTC5nZXQoIkVYUFVOTyIpLnRvU3RyaW5nKCkudHJpbSgpLCBFWFRNUEwuZ2V0KCJFWFBOTEkiKS50b1N0cmluZygpLnRyaW0oKSwgd2FyZWhvdXNlKTsNCiAgICAgIHpPUk5PID0gbG9hZElkOw0KICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgfQ0KICANCiAgLyoqDQogICAqIFJldHJpZXZlIHVuaXQgb2YgbWVhc3VyZQ0KICAgKiovDQogIHByaXZhdGUgU3RyaW5nIGdldFVuaXRPZk1lYXN1cmUoU3RyaW5nIHNjYWxlSWQpIHsNCiAgICBTdHJpbmcgdW5pdCA9ICIiOw0KICAgIGRlZiBwYXJhbUl0ZW0gPSBbIkNPTk8iIDogaW5DT05PLCAiSVROTyIgOiBzY2FsZUlkXQ0KICAgIENsb3N1cmU8Pz4gaGFuZGxlckl0ZW0gPSB7DQogICAgICBNYXA8U3RyaW5nLCBTdHJpbmc+IHJlc3BvbnNlIC0+IA0KICAgICAgaWYgKHJlc3BvbnNlLklUTk8gIT0gbnVsbCkgew0KICAgICAgICB1bml0ID0gcmVzcG9uc2UuVU5NUy50cmltKCk7DQogICAgICB9DQogICAgfQ0KICAgIG1pQ2FsbGVyLmNhbGwoIk1NUzIwME1JIiwiR2V0SXRtQmFzaWMiLCBwYXJhbUl0ZW0sIGhhbmRsZXJJdGVtKTsNCiAgICByZXR1cm4gdW5pdDsNCiAgfQ0KICANCiAgLyoqDQogICAqIEdldCB0aW1lIGluIFVUQyB0aW1lem9uZQ0KICAgKiovDQogIHByaXZhdGUgWm9uZWREYXRlVGltZSBnZXRVVENEYXRlVGltZShTdHJpbmcgd2FyZWhvdXNlLCBTdHJpbmcgZGF0ZSwgU3RyaW5nIHRpbWUpIHsNCiAgICBTdHJpbmcgb2Zmc2V0LCB3YXJlaG91c2VEYXRlVGltZTsNCiAgICANCiAgICBkZWYgcGFyYW1XYXJlaG91c2UgPSBbIldITE8iIDogd2FyZWhvdXNlLCAiREFURSIgOiBkYXRlLCAiVElNRSIgOiB0aW1lXQ0KICAgIGRlZiBjYWxsYmFja1dhcmVob3VzZSA9IHsNCiAgICAgIE1hcDxTdHJpbmcsIFN0cmluZz4gcmVzcG9uc2UgLT4gDQogICAgICBpZiAocmVzcG9uc2UuVElaTyAhPSBudWxsKSB7DQogICAgICAgIHdhcmVob3VzZURhdGVUaW1lID0gcmVzcG9uc2UuREFURS50cmltKCkgKyAiICIgKyByZXNwb25zZS5USU1FLnRyaW0oKTsNCiAgICAgICAgb2Zmc2V0ID0gcmVzcG9uc2UuVEdNVC5zdWJzdHJpbmcoMCwgMykgKyAiOiIgKyByZXNwb25zZS5UR01ULnN1YnN0cmluZygzKTsNCiAgICAgIH0NCiAgICB9DQogICAgbWlDYWxsZXIuY2FsbCgiRFJTMDQ1TUkiLCJHZXRXSExPRGF0YSIsIHBhcmFtV2FyZWhvdXNlLCBjYWxsYmFja1dhcmVob3VzZSk7DQogICAgDQogICAgRGF0ZVRpbWVGb3JtYXR0ZXIgZm9ybWF0dGVyID0gRGF0ZVRpbWVGb3JtYXR0ZXIub2ZQYXR0ZXJuKCJ5eXl5TU1kZCBISG1tc3MiKTsNCiAgICANCiAgICBpZiAod2FyZWhvdXNlRGF0ZVRpbWUgPT0gbnVsbCkgew0KICAgICAgd2FyZWhvdXNlRGF0ZVRpbWUgPSBMb2NhbERhdGVUaW1lLm5vdygpLmZvcm1hdChmb3JtYXR0ZXIpOw0KICAgICAgb2Zmc2V0ID0gIiswMTowMCI7DQogICAgfQ0KICAgIA0KICAgIExvY2FsRGF0ZVRpbWUgbGR0ID0gTG9jYWxEYXRlVGltZS5wYXJzZSh3YXJlaG91c2VEYXRlVGltZSwgZm9ybWF0dGVyKTsNCiAgICBab25lT2Zmc2V0IHpvbmVPZmZzZXQgPSBab25lT2Zmc2V0Lm9mKG9mZnNldCk7DQogICAgT2Zmc2V0RGF0ZVRpbWUgb2R0ID0gT2Zmc2V0RGF0ZVRpbWUub2YobGR0LCB6b25lT2Zmc2V0KTsNCiAgICBab25lZERhdGVUaW1lIHV0Y1pkdCA9IG9kdC5hdFpvbmVTYW1lSW5zdGFudChab25lT2Zmc2V0LlVUQyk7DQogICAgcmV0dXJuIHV0Y1pkdDsNCiAgfQ0KICANCiAgDQp9"}}}